<p-table [columns]="cols" [value]="users" selectionMode="single" [(selection)]="selectedUser"
         (onRowSelect)="onRowSelect($event)" [paginator]="true" [rows]="10">

  <ng-template pTemplate="caption">
    List of Users
  </ng-template>
  <ng-template pTemplate="header" let-columns>
    <tr>
      <th *ngFor="let col of columns">
        {{col.header}}
      </th>
    </tr>
  </ng-template>

  <ng-template pTemplate="body" let-rowData let-columns="columns">
    <tr [pSelectableRow]="rowData">
      <td *ngFor="let col of columns">
        {{rowData[col.field]}}
      </td>
    </tr>
  </ng-template>

  <ng-template pTemplate="summary" let-rowData>
    <div style="text-align:left">
      <button type="button" pButton icon="fa fa-plus" (click)="add()" label="Add"></button>
    </div>
  </ng-template>
</p-table>
<p-dialog header="User Details" [(visible)]="displayDialog" [responsive]="true" showEffect="fade" [modal]="true"
          [style]="{width: '400px'}">
  <div class="ui-g ui-fluid" *ngIf="user">
    <div class="ui-g-12">
      <div class="ui-g-4">
        <label for="usernameEdit">Username</label>
      </div>
      <div class="ui-g-8">
        <input pInputText id="usernameEdit" [(ngModel)]="user.username" disabled/>
      </div>
    </div>
  </div>

  <div class="ui-g ui-fluid" *ngIf="user">
    <div class="ui-g-12">
      <div class="ui-g-4">
        <label for="firstNameEdit">First Name</label>
      </div>
      <div class="ui-g-8">
        <input pInputText id="firstNameEdit" [(ngModel)]="user.firstName" required
               pattern="^[A-ZÜÄÖÂÎĂȚȘÁÉÓŐÚŰ][a-zA-Zșțăîâäöüßáéóőúű]{1,30}[- ]?[a-zșțăîâäöüáéóőúűßA-ZÜÄÖÂÎĂȚȘÁÉÓŐÚŰ]{0,30}[a-zșțăîâäöüßáéóőúű]$"
               #firstNameEdit="ngModel"/>
        <div class="alert alert-danger"
             *ngIf="firstNameEdit.touched && firstNameEdit.invalid">
          <div *ngIf="firstNameEdit.errors.required">
            First name is required!
          </div>
          <div *ngIf="firstNameEdit.errors.pattern">
            First name should start with capital letter and should contain only letters and separators!
          </div>
        </div>
      </div>
    </div>

    <div class="ui-g-12">
      <div class="ui-g-4">
        <label for="lastNameEdit">Last Name</label>
      </div>
      <div class="ui-g-8">
        <input pInputText id="lastNameEdit" [(ngModel)]="user.lastName" required #lastNameEdit="ngModel"
               pattern="^[A-ZÜÄÖÂÎĂȚȘÁÉÓŐÚŰ][a-zA-Zșțăîâäöüßáéóőúű]{1,30}[- ]?[a-zșțăîâäöüáéóőúűßA-ZÜÄÖÂÎĂȚȘÁÉÓŐÚŰ]{0,30}[a-zșțăîâäöüßáéóőúű]$"/>
        <div class="alert alert-danger"
             *ngIf="lastNameEdit.touched && lastNameEdit.invalid">
          <div *ngIf="lastNameEdit.errors.required">
            Last name is required!
          </div>
          <div *ngIf="lastNameEdit.errors.pattern">
            Last should start with capital letter and should contain only letters and separators!
          </div>
        </div>
      </div>
    </div>

    <div class="ui-g-12">
      <div class="ui-g-4">
        <label for="mobileNumberEdit">Mobile Number</label>
      </div>
      <div class="ui-g-8">
        <input pInputText id="mobileNumberEdit" [(ngModel)]="user.mobileNumber" required #mobileNumberEdit="ngModel"
               minlength="10" maxlength="13"
               pattern="^(\+49)?1(5[12579]|6[023]|7[0-9])[0-9]{7}$|^(004|\+4)?07[2-8][0-9]{7}$"/>
        <div class="alert alert-danger"
             *ngIf="mobileNumberEdit.touched && mobileNumberEdit.invalid">
          <div *ngIf="mobileNumberEdit.errors.required">
            Mobile number is required!
          </div>
          <div *ngIf="mobileNumberEdit.errors.pattern">
            Mobile number must be from Germany or Romania!
          </div>
          <div *ngIf="mobileNumberEdit.errors.minlength">
            Mobile number should have at least 10 characters!
          </div>
        </div>
      </div>
    </div>

    <div class="ui-g-12">
      <div class="ui-g-4">
        <label for="emailEdit">Email</label>
      </div>
      <div class="ui-g-8">
        <input pInputText id="emailEdit" [(ngModel)]="user.email" required #emailEdit="ngModel"
               pattern="^[a-zA-Z0-9-_.]*@msggroup\.com$"/>
        <div class="alert alert-danger"
             *ngIf="emailEdit.touched && emailEdit.invalid">
          <div *ngIf="emailEdit.errors.required">
            Email is required!
          </div>
          <div *ngIf="emailEdit.errors.pattern">
            Email must be of format [address]@msggroup.com!
          </div>
        </div>
      </div>
    </div>


    <div class="ui-g-12">
      <div class="ui-g-4">
        <label for="rolesEdit">Edit roles</label>
      </div>
    </div>
    <table>
    <tr *ngFor="let role of roles">
      <label>
        <input type="checkbox"
               name="roles"
               value="{{role.id}}"
               id="rolesEdit"
               (change)="onClicked(role, $event)"
               [defaultChecked]="role.checked"
        />
        {{role.type}}<br>
      </label>
    </tr>
    </table>

    <div class="ui-g-12">
      <div class="ui-g-4">
        <label for="statusEdit">Status</label>
      </div>
      <div class="ui-g-8">
        <input pInputText id="statusEdit" [(ngModel)]="user.status" disabled/>
      </div>
    </div>
  </div>
  <p-footer>
    <div class="ui-dialog-buttonpane ui-helper-clearfix">
      <button type="button" pButton icon="fa fa-close" (click)="activateUser()" label="Activate"
              [disabled]="user.status"></button>
      <button type="button" pButton icon="fa fa-close" (click)="deactivateUser()" label="Deactivate"
              [disabled]="!user.status"></button>
      <button type="button" pButton icon="fa fa-check" (click)="edit()" label="Edit"></button>
    </div>
  </p-footer>
</p-dialog>
